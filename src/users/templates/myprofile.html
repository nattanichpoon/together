{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load staticfiles %}


{% block head_title %} My Page {% endblock %}


{% block extrahead %}
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
      google.charts.load("current", {packages:["corechart", "bar"]});
      google.charts.setOnLoadCallback(drawChart);
      function drawChart() {
      	//data for donut chart
        var data = google.visualization.arrayToDataTable([
          ['Progress', 'Tasks'],
          ['In progress', {{inprogress}}],
          ['Awaiting',  {{ awaiting }}],
          ['Completed', {{completed}}]
         
        ]);     
        var options = {
          pieHole: 0.7,
          colors: ['#1FB58F','#EAB126', '#F24C4E'],
          // legend: 'none',
          backgroundColor: { fill: "#F5F1ED" },
          pieSliceText: 'none',
          height: 400,
          width: 400,
          legend: {
                 position: 'right',
                 alignment: 'top'
             },
             chartArea: { 
                 left: 10, 
                 top: 10, 
                 width: '130%', 
                 height: '65%',
             },
             // pieStartAngle: 180,
        };
        //date for bar graph
        var data2 = google.visualization.arrayToDataTable([
          ['Project', 'Average', 'Your'],
          ['All Projects', 2000, 400],
        ]);

        var options2 = {
          chart: {
            title: 'Personal Contribution Summary',
            subtitle: 'Personal contribution VS. Average contribution',
            chartArea: { 
                 left: 10, 
                 top: 10, 
                 width: '130%', 
                 height: '65%',
             },
          }
        };
      


        var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
        chart.draw(data, options);
        
  //       var chart2 = new google.charts.Bar(document.getElementById('columnchart_material'));
		// chart2.draw(data2, options2);
    

      }
    </script>
{% endblock %}

{% block content %}
<div class="col-sm-10 col-sm-offset-1">
	<div class="row">
		{% if profile %}
		<h4 style="text-align:center">Welcome, <strong>{{profile}}</strong>.</h4>
		{% else %}
		<h4 class="strong pull-right">Click Edit Profile to add your name.<span class="glyphicon glyphicon-hand-up" aria-hidden="true"></span></h4>
		{% endif %}

   
	</div>
  <div class="row">
   
    <div class="col-sm-5 col-xs-5">
      <!-- <a href="{% url 'about' %}" class="fancy-button bg-gradient3 "><span>See Our Features</span></a> -->
      </div>
      <div class="col-sm-3 col-xs-3">
      <img src="{% static 'img/' %}{{profile.avatar}}" style="width:100px; height:100px;">
    </div>
      <a href="{% url 'project_new' %}" class="fancy-button bg-gradient2 "><span>Start New Project</span></a>
  </div>
  <hr>

  

  {% if projects_count > 0 %}
  
  <div class="row">
  	<div class="col-sm-5">
  		<div style="z-index:5; left:90px;top:85px; width: 100px; height: 100px; line-height:100px; text-align:center; position: absolute; font-size:20px"> 
  				{{projects_count}} {% if projects_count > 1 %}projects{% else %}project{% endif %}
  		</div>
  		<div id="donutchart"> </div>
  	</div>


  	<div class="col-sm-4" style="z-index:3;position:absolute; right:5px;">
  		<!-- <div class="row" style="height:500px;"> -->
  		<div style="height:400px; overflow:scroll;  padding:20px; background-color: rgba(0,0,0,0.1);border-radius:5px">
  			<h4 class="lead">Your Tasks</h4>
  			<div class="list-group">
  				{% for task in inProgressTasks  %}
     				<a href="#" class="list-group-item"> 
              <h4 class="list-group-item-heading">{{task}} <span style="float:right"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="16px" height="16px" viewBox="0 0 16 16"><g ><path fill="#18aa7c" d="M8,0C3.6,0,0,3.6,0,8s3.6,8,8,8s8-3.6,8-8S12.4,0,8,0z M6,5c0.6,0,1,0.4,1,1S6.6,7,6,7S5,6.6,5,6S5.4,5,6,5z&#10;&#9; M8,12c-1.7,0-3-1.3-3-3h6C11,10.7,9.7,12,8,12z M10,7C9.4,7,9,6.6,9,6s0.4-1,1-1s1,0.4,1,1S10.6,7,10,7z"/></g></svg></span></h4>
  					<p class="list-group-item-text">{{task.project}}</p>
  				</a>
  				{% endfor %}
  			</div>
  			<div class="list-group">
  				{% for task in awaitingTasks  %}
  				<a href="#" class="list-group-item"> 
  					<h4 class="list-group-item-heading">{{task}} <span style="float:right"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="16px" height="16px" viewBox="0 0 16 16"><g ><path fill="#e1a201" d="M8,0C3.6,0,0,3.6,0,8s3.6,8,8,8s8-3.6,8-8S12.4,0,8,0z M6,5c0.6,0,1,0.4,1,1S6.6,7,6,7S5,6.6,5,6S5.4,5,6,5z&#10;&#9; M8,12c-1.7,0-3-1.3-3-3h6C11,10.7,9.7,12,8,12z M10,7C9.4,7,9,6.6,9,6s0.4-1,1-1s1,0.4,1,1S10.6,7,10,7z"/></g></svg></span></h4>
  					<p class="list-group-item-text">{{task.project}}
  					</p>
  				</a>
  				{% endfor %}
  			</div>
  		</div>
  	</div>
  </div>
{% endif %}

<div class="row">
		<div class="col-sm-12">
      <hr>
		<h3>Your History</h3> 
    <!-- <div class="col-sm-6">
			<div id="columnchart_material" style="height:400px"></div>
    </div> -->
        <div class="col-sm-12">
          <div class="item  col-xs-3 col-sm-3">
            <h4>Your Peer Ratings</h4>
               <a href = "{% url 'myratings' %}" style= "color:white;"><button type="button" class="btn btn-circle"> <h1>{{avgRating}}%</h1></button></a>
          </div>
          <div class="item  col-xs-3 col-sm-3">
            <h4>Completed Tasks</h4>
            <div id="circle-small" style="color:white;"> <h1>{{completed}}</h1>
             </div>
          </div>
          <div class="item  col-xs-3 col-sm-3">
            <h4>Task Score</h4>

               <div id="circle-small" style="color:white;"><h1>{{avgTask}}</h1>
                            </div>
          </div>
          <div class="item  col-xs-3 col-sm-3">
            <h4>Completed Projects</h4>

               <div id="circle-small" style="color:white;"> <h1>{{projects_completed}}</h1>
                            </div>
          </div>
        </div>
	</div>
</div>



{% endblock %}

